<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui">

<ui:composition template="_template.xhtml">

	<ui:define name="titulo">Cadastro de Livro</ui:define>
	<ui:define name="conteudo">
		<h:form id="formLivro">
			<p:messages id="messages" autoUpdate="true" />
			<p:growl autoUpdate="true" />
			<p:fieldset>
				<p:outputLabel >Dados do Livro</p:outputLabel>
				<h:panelGrid columns="4" style="margin-bottom:10px" cellpadding="5">

					<p:outputLabel value="Titulo:" for="titulo" />
					<p:inputText id="titulo" value="#{livroBean.livro.titulo}"
						required="true" requiredMessage="Título obrigatório"
						validatorMessage="Título não pode ser superior a 40">
						<f:validateLength maximum="40" />
						<f:ajax event="blur" render="messages" />
					</p:inputText>

					<p:outputLabel value="Subtitulo:" for="subtitulo" />
					<p:inputText id="subtitulo" value="#{livroBean.livro.subtitulo}" />

					<p:outputLabel value="ISBN:" for="isbn" />
					<p:inputMask id="isbn" value="#{livroBean.livro.isbn}"
						mask="999-9-99-999999-9" />

					<p:outputLabel value="Cutter:" for="cutter" />
					<p:inputText id="cutter" value="#{livroBean.livro.cutter}" />

					<p:outputLabel value="Ano:" for="ano" />
					<p:inputText id="ano" value="#{livroBean.livro.ano}" />

					<p:outputLabel value="Nº de Páginas:" for="numPaginas" />
					<p:inputText id="numPaginas" value="#{livroBean.livro.numPaginas}" />

					<p:outputLabel value="Classificação:" for="classificacao" />
					<p:inputText id="classificacao"
						value="#{livroBean.livro.classificacao}" />

					<p:outputLabel value="Editora:" for="editora" />
					<p:autoComplete value="#{livroBean.livro.editora}" id="editora"
						completeMethod="#{livroBean.likeEditoraByNome}" var="e"
						itemLabel="#{e.nome}" itemValue="#{e}"
						converter="editoraConverter" forceSelection="true" required="true" />

					<p:outputLabel value="Local:" for="local" />
					<p:autoComplete value="#{livroBean.livro.local}" id="local"
						completeMethod="#{livroBean.likeLocalByNome}" var="l"
						itemLabel="#{l.nome}" itemValue="#{l}" converter="localConverter"
						required="true" />

					<p:outputLabel value="Autores:" for="autores" />
					<p:autoComplete id="autores" value="#{livroBean.livro.autores}"
						completeMethod="#{livroBean.likeAutorByNome}" var="a"
						itemLabel="#{a.nome}" itemValue="#{a}" converter="autorConverter"
						forceSelection="true" multiple="true" />

					<p:outputLabel value="É Ilustrado?" for="ehIlustrado" />
                    <p:selectBooleanCheckbox id="ehIlustrado" value="#{livroBean.livro.ehIlustrado}" /> 
					

					<p:outputLabel value="Assuntos" for="assuntos" />
					<p:autoComplete id="assuntos" value="#{livroBean.livro.assuntos}"
						completeMethod="#{livroBean.likeAssuntoByNome}" var="a"
						itemLabel="#{a.assunto}" itemValue="#{a}"
						converter="assuntoConverter" forceSelection="true" multiple="true" />

				</h:panelGrid>

				<p:commandButton value="Cadastrar" action="#{livroBean.gravar}"
					process="@form" update="@form :tabelaLivros" />
			</p:fieldset>


		</h:form>

<br/>
		<p:fieldset>
			<p:outputLabel >Últimos Livros Cadastrados</p:outputLabel>
			<p:dataTable rows="10" paginator="false" paginatorPosition="bottom"
				id="tabelaLivros" value="#{livroBean.listaLivros}" var="livro"
				emptyMessage="Nenhum Livro cadastrado">

				<p:column resizable="true">
					<f:facet name="header">Título</f:facet>
					<h:outputText value="#{livro.titulo}" />
				</p:column>

				<p:column>
					<f:facet name="header">ISBN</f:facet>
					<h:outputText value="#{livro.isbn}" />
				</p:column>
				<p:column>
					<f:facet name="header">Ano</f:facet>
					<h:outputText value="#{livro.ano}" />
				</p:column>
				<p:column>
					<f:facet name="header">Editora</f:facet>
					<h:outputText value="#{livro.editora.nome}" />
				</p:column>
				<p:column>
					<f:facet name="header">Local</f:facet>
					<h:outputText value="#{livro.local.nome}" />
				</p:column>

				<p:column>
					<f:facet name="header">Autores</f:facet>
					<h:outputText value="#{livro.autores}" />
				</p:column>

				<p:column>
					<f:facet name="header">Assuntos</f:facet>
					<h:outputText value="#{livro.assuntos}" />
				</p:column>
			</p:dataTable>
		</p:fieldset>
	</ui:define>
	<ui:define name="texto">
		Cadastro de Livros	
	</ui:define>
</ui:composition>

</html>