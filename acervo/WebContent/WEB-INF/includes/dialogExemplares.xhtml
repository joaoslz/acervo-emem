<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui">




	<!-- DIALOG EXEMPLARES...................................................................................... -->

	<p:dialog header="Cadastro de Exemplares" widgetVar="dlgExemplares"
		resizable="false" closable="false" modal="true" width="700px">
		<h:form id="formExemplares">

			<b><h:outputText value="Título: " /></b>
			<h:outputText value="#{itemAcervoBean.itemAcervo.titulo}" />
			<br/><br/>
			<p:message for="qtd" />
			<p:panelGrid style="width:100%">
				<p:row>
					<p:column><p:outputLabel value="Qtd Exemplares: " /></p:column>
					<p:column>
					<p:spinner id="qtd" value="#{itemAcervoBean.exemplaresAdd.quantidade}" max="300" min="1" size="3" validatorMessage="Você deve cadastrar no mínimo 1 exemplar!">
						<f:validateLongRange minimum="1" for="qtd" />
					</p:spinner>
					</p:column>
					<p:column><p:outputLabel value="Data de Aquisição: " /></p:column>
					<p:column><p:calendar value="#{itemAcervoBean.exemplaresAdd.dataAquisicao}" locale="pt_BR" display="inline" navigator="true" size="10"/></p:column>
					<p:column><p:outputLabel value="É Doaçao? " /></p:column>
					<p:column><p:selectBooleanCheckbox value="#{itemAcervoBean.exemplaresAdd.ehDoacao}" /></p:column>
				</p:row>
			</p:panelGrid>

			<p:toolbar style="margin-top: 2px;margin-bottom:10px;">
				<f:facet name="right">
					<p:commandButton value="Gravar"
						action="#{itemAcervoBean.cadastrarExemplares}"
						update="@form :formExemplares:tabelaExemplares " />
						
					<p:separator />
						
					<!--............Ao sair da tela de exemplares é preciso limpar form e a lista de exemplares....-->
					<p:commandButton value="Sair" action="#{itemAcervoBean.limparForm}"
						actionListener="#{itemAcervoBean.limparListaExemplares}" immediate="true"
						oncomplete="PF('dlgExemplares').hide()" update=":form" />

				</f:facet>
			</p:toolbar>

			<p:messages autoUpdate="true" globalOnly="true" style="color:#0f0;" />
			<p:dataTable id="tabelaExemplares" value="#{itemAcervoBean.exemplares}"
				var="exemplar" emptyMessage="Nenhum Exemplar cadastrado"
				editable="true">
				<p:ajax event="rowEdit" listener="#{itemAcervoBean.editExempar}"
					update=":formExemplares:tabelaExemplares" />

				<p:columnGroup type="header">
					<p:row>
						<p:column colspan="5" headerText="Exemplares Cadastrados" />
					</p:row>
					<p:row>
						<p:column headerText="ID" />
						<p:column headerText="É Doação" />
						<p:column headerText="Data de Aquisição" />
						<p:column headerText="Observação" />
						<p:column headerText="Alterar" />
					</p:row>
				</p:columnGroup>

				<p:column>
					<h:outputText value="#{exemplar.id}" />
				</p:column>
				<p:column>
					<p:cellEditor>
						<f:facet name="output">
							<h:outputText rendered="#{exemplar.ehDoacao}" value="Sim" />
							<h:outputText rendered="#{!exemplar.ehDoacao}" value="Não" />
						</f:facet>
						<f:facet name="input">
							<p:selectBooleanCheckbox value="#{exemplar.ehDoacao}" />
						</f:facet>
					</p:cellEditor>
				</p:column>
				<p:column>
					<p:cellEditor>
						<f:facet name="output">
							<h:outputText value="#{exemplar.dataAquisicao.time}">
								<f:convertDateTime pattern="dd/MM/yyyy" />
							</h:outputText>
						</f:facet>
						<f:facet name="input">
							<p:calendar value="#{exemplar.dataAquisicao}"
								converter="#{calendarConverter}" pattern="dd/MM/yyyy" />
						</f:facet>
					</p:cellEditor>
				</p:column>
				<p:column>
					<p:cellEditor >
						<f:facet name="output">
							<h:outputText value="#{exemplar.observacao}" />
						</f:facet>
						<f:facet name="input">
							<p:inputText value="#{exemplar.observacao}" />
						</f:facet>
					</p:cellEditor>
				</p:column>
				<p:column >
					<p:rowEditor />
				</p:column>
			</p:dataTable>
		</h:form>
	</p:dialog>

	<!-- DIALOG DESEJA CADASTRAR EXEMPLARES...................................................................... -->
	<p:dialog header="Cadastro de Exemplar(es)"
		widgetVar="dlgConfirmaExemplares" closable="false" modal="true"
		resizable="false">
		<h:form>
			<h:panelGrid columns="3">
				<p:outputLabel value="Deseja cadastrar algum exemplar? " />

				<p:commandButton value="Sim"
					oncomplete="PF('dlgConfirmaExemplares').hide();PF('dlgExemplares').show()"
					process="@form"
					update=":formExemplares :formExemplares:tabelaExemplares" />
				<p:commandButton value="Não"
					oncomplete="PF('dlgConfirmaExemplares').hide();"
					action="#{itemAcervoBean.limparForm}" process="@form"
					update=":form" />
			</h:panelGrid>
		</h:form>
	</p:dialog>

</ui:composition>